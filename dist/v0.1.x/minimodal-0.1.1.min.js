/**
 * @license
 * Copyright (C) 2013 Steven Berry (http://www.sberry.me/minimodal)
 * Licensed: MIT (http://opensource.org/licenses/mit-license.php)
 * 
 * Steven Berry
 * www.sberry.me
 * steven@sberry.me
 */
!function(t,e){function o(t,o){var n={};return e.isFunction(this.eventData)&&e.extend(n,this.eventData.call(this.obj)),e.extend(n,o||{}),n.type=t,n}function n(t,o){return o.obj=t,o.parent=t.parent(),o.focused=document.activeElement,e.extend(this,o),this}var i;e(document).ready(function(){e(document.body).append('<div id="minimodal-shade"></div>'),i=e("#minimodal-shade").hide(),e(document).delegate(".modal-close","click",function(){e.modal.close()})}),n.prototype={open:function(){return e.isFunction(this.preOpen)&&this.preOpen.apply(this.obj,arguments),e(document.body).append(this.obj),this.obj.after(i),i.show(),this.obj.show().css({marginTop:-this.obj.outerHeight()/2,marginLeft:-this.obj.outerWidth()/2}).trigger(o.call(this,"modalopen")),this.obj.find("input, select, textarea, button").first().focus(),e.isFunction(this.postOpen)&&this.postOpen.apply(this.obj,arguments),e(document).on("keydown.modal",function(t){t.stopPropagation(),27==t.which&&e.modal.close()}),this},close:function(t){return e.isFunction(this.preClose)&&this.preClose.apply(this.obj,arguments),i.hide(),this.obj.hide().trigger(o.call(this,"modalclose",t)),this.parent.append(this.obj),e(this.focused).focus(),e.modal=null,e.isFunction(this.postClose)&&this.postClose.apply(this.obj,arguments),e(document).off("keydown.modal"),this}},e.fn.extend({modal:function(t){return t=t||{},this.length>=1&&this[0].nodeType?(e.modal instanceof n&&e.modal.close(),e.modal=new n(this.first(),t).open()):void 0}})}(this,jQuery);